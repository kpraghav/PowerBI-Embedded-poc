<!DOCTYPE html>
<html>
<head>
  <title>Power BI Embed Edit Mode</title>
  <script src="https://cdn.powerbi.com/libs/powerbi-client/2.19.0/powerbi.min.js"></script>
  <style>
    #reportContainer {
      width: 100%;
      height: 600px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <h2>Power BI Report Embed</h2>

  <div id="reportContainer"></div>

  <button onclick="embedReport()">Switch to Edit Mode</button>

  <script>
    // These values should come from your backend or POC settings
    const accessToken = "YOUR_EDIT_MODE_EMBED_TOKEN";
    const embedUrl = "YOUR_EMBED_URL";
    const reportId = "YOUR_REPORT_ID";

    function embedReport() {
      const models = window['powerbi-client'].models;

      const config = {
        type: 'report',
        tokenType: models.TokenType.Embed,
        accessToken: accessToken,
        embedUrl: embedUrl,
        id: reportId,
        permissions: models.Permissions.All, // Required for Edit Mode
        viewMode: models.ViewMode.Edit,      // <- This is the Edit Mode
        settings: {
          panes: {
            filters: {
              visible: true
            },
            pageNavigation: {
              visible: true
            }
          }
        }
      };

      const reportContainer = document.getElementById('reportContainer');
      powerbi.embed(reportContainer, config);
    }
  </script>

</body>
</html>
